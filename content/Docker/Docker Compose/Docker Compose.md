---
{"dg-publish":true,"permalink":"/docker/docker-compose/docker-compose/","dgPassFrontmatter":true}
---
### 도커 컴포즈

#### 도커 컴포즈란?

- 시스템 구축과 관련된 명령어를 하나의 텍스트 파일에 기재해, 명령어 한번에 시스템 전체를 실행하고, 종료와 폐기까지 한번에 하도록 도와주는 도구이다.
- 도커 파일이 하나의 프로그램을 구축하기 위한 파일이었다면, 도커 컴포즈는 여러 프로그램으로 이루어진 하나의 시스템을 구축하기 위한 파일이라 생각했다.
- 도커 엔진의 명령어를 도커 컴포즈 파일로 작성하여 자동으로 명령을 실행해 주는 역할을 한다.

#### 도커 컴포즈 설치

- 도커 컴포즈는 도커 엔진과 별개의 소프트웨어이므로, 설치가 필요하다.
- 하지만 설치하고 나면 별도의 설정 없이, 커맨드만 달리하여 사용할 수 있다.
- 도커 데스크톱을 사용하는 경우, 도커 컴포즈가 함께 설치된다.

#### 도커 컴포즈 사용법

- 도커 파일을 이용해 이미지를 빌드할 때 처럼 호스트 컴퓨터에 폴더를 만들고, 이 폴더에 도커 컴포즈 파일을 작성한다.
- `docker-compose.yml`이라는 지정 이름을 사용해야 한다.
- `docker-compose` 파일 작성 후 `docker-compose`의 up 커맨드를 사용하여 컴포즈 파일에 정의된 컨테이너와 네트워크 등을 생성한다.
- down 커맨드로는 생성된 컨테이너와 네트워크를 종료하고 삭제한다.
- `docker-compose -f [컴포즈 파일 경로] 커맨드 [옵션]` 구조이다.

#### 컴포즈 파일 작성방법

- 컴포즈 파일 작성 기본 문법
    - version : 컴포즈 파일의 버전
    - services : 실행할 컨테이너
        - 줄 바꿈 후, 컨테이너 이름들을 적는다.
        - image : 사용할 이미지 지정
        - networks : 접속할 네트워크 지정
        - volumes : 스토리지 마운트 지정
        - ports : 포트 설정
        - environment : 환경변수 설정
        - depends_on : 다른 서비스에 대한 의존관계 정의
        - restart : 컨테이너 종료 시 재시작 여부 설정
    - networks : 네트워크 이름
        - 줄 바꿈 후, 네트워크 이름 설정
    - volumes : 볼륨 이름
        - 줄 바꿈 후, 볼륨 이름 설정
- 지난 포스트에서 gradle로 빌드했던 이미지를 이용하여 컴포즈 파일로 컨테이너를 생성해 보았다.  
    
    ![](https://i.imgur.com/cit1I1q.png)
    

![](https://i.imgur.com/AzFVdip.png)

- compose 라는 이름으로 ims-api-compose 컨테이너가 실행되었다.  
    ![](https://i.imgur.com/FdxhIeE.png)
- compose 라는 이름으로 묶여서 관리되는 것 같아 전에 했던 실습 내용을 추가로 작성해 보았다.  
    ![](https://i.imgur.com/KnmNhJ8.png)